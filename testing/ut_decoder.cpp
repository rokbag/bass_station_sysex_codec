#include <gtest/gtest.h>
#include "codec/decoder.h"


class ut_decoder : public decoder, public testing::Test
{
};


TEST_F(ut_decoder, decode_test)
{
    const data_t dump = {0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x4b, 0x53, 0x78, 0x02, 0x00, 0x03, 0x20, 0x0f, 0x6f, 0x77, 0x78, 0x01, 0x00, 0x43, 0x40, 0x20, 0x00, 0x03, 0x7f, 0x7f, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x32, 0x55, 0x36, 0x08, 0x36, 0x00, 0x0f, 0x77, 0x7a, 0x70, 0x00, 0x73, 0x00, 0x17, 0x03, 0x05, 0x30, 0x00, 0x00, 0x59, 0x00, 0x11, 0x20, 0x00, 0x00, 0x00, 0x60, 0x00, 0x13, 0x00, 0x00, 0x20, 0x20, 0x08, 0x0a, 0x1f, 0x19, 0x10, 0x09, 0x14, 0x02, 0x01, 0x00, 0x46, 0x20, 0x1f, 0x6f, 0x78, 0x02, 0x39, 0x26, 0x40, 0x3f, 0x50, 0x08, 0x04, 0x01, 0x7c, 0x7e, 0x40, 0x34, 0x40, 0x00, 0x00, 0x03, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf7};

    auto result = decode(dump, 0);
    EXPECT_EQ(6, result[EParam::FilterFrequency]);
}


TEST_F(ut_decoder, decode_filter_frequency)
{
    auto result = decode_filter_frequency(0, 0);
    EXPECT_EQ(0, result);
    result = decode_filter_frequency(255, 255);
    EXPECT_EQ(255, result);
}

TEST_F(ut_decoder, decode_filter_resonance)
{
    auto result = decode_filter_resonance(0, 0);
    EXPECT_EQ(0, result);
    result = decode_filter_resonance(255, 255);
    EXPECT_EQ(127, result);
}

TEST_F(ut_decoder, decode_filter_overdrive)
{
    auto result = decode_filter_overdrive(0, 0);
    EXPECT_EQ(0, result);
    result = decode_filter_overdrive(255, 255);
    EXPECT_EQ(127, result);
}

